🐙 Octopus Bot 2026 기능 명세서
이 봇은 **자동 종목 발굴(Scanning)**부터 정밀 타점 진입(Entry), 리스크 관리(Risk Management), **매매 기록(Logging)**까지 전 과정을 수행하는 올인원(All-in-One) 시스템 트레이딩 봇입니다.

1. 🔍 종목 선별 기준 (Auto Discovery)
market_scanner.py와 main.py의 auto_tuner_loop가 4시간마다 시장 전체를 스캔하여 타겟 코인을 자동으로 교체합니다.

1차 필터 (유동성 공급): 업비트 원화 마켓 전 종목 중 24시간 거래대금 상위 40개를 1차 후보로 선정하여, 거래량이 없는 '잡코인'을 배제합니다.

2차 필터 (기술적 지표): 다음 중 하나를 만족하는 종목을 최종 타겟으로 선정합니다.

RSI 과매도: RSI(14) 지표가 40 이하인 경우.

볼린저 밴드 하단: 현재 가격이 볼린저 밴드 하단 1% 범위 내에 접근한 경우.

안전장치: 조건에 맞는 종목이 3개 미만일 경우, 대장주인 BTC, ETH, XRP를 강제로 타겟에 포함시킵니다.

2. 🚀 매수 진입 조건 (Entry Strategy)
선별된 종목이라도 무조건 사지 않습니다. strategy/signal_maker.py에서 다음 조건들을 모두 통과해야만 진입합니다.

A. 사전 필수 검증 (Pre-Check)
김프(Kimchi Premium) 제한: 김프가 5%(MAX_KIMP_THRESHOLD) 이상 끼어있으면 매수 금지.

틱 효율성(BEP) 검사: 수수료(0.1%)를 극복하기 위해 필요한 호가 단위가 15틱(MAX_TICKS_FOR_BEP) 이상이면 매수 금지 (수익 내기 힘든 구조).

허매수(Spoofing) 필터링: 호가창에서 매수벽은 두꺼운데(Bid > Ask * 2), 최근 3초간 실제 매수 체결액이 100만 원 미만이면 **'허매수'**로 판단하여 진입 취소.

B. 진입 전략 (Signal Logic)
두 가지 전략 중 하나가 만족되면 매수합니다.

전략 1: 정밀 타점 (Precision Entry) - 일반적인 경우

RSI 과매도: RSI(14)가 25 미만.

볼린저 밴드: 가격이 밴드 하단을 터치하거나 이탈.

골든 크로스: 단기 RSI(9)가 장기 RSI(14)를 상향 돌파.

VWAP 지지: 현재가가 세력 평단가(VWAP)의 99.5% 이상에서 지지받고 있음.

전략 2: 역프리미엄 스나이퍼 (Reverse Premium) - 특수 상황

조건: 김프가 -1.0% 이하(역프)인 경우.

완화된 기준: RSI가 35 미만이어도 공격적으로 진입합니다.

3. 💰 매도 및 청산 조건 (Exit Strategy)
execution/risk_manager.py에서 수익을 확정하거나 손실을 방어합니다.

A. 익절 (Take Profit)
분할 익절 (Sell Half): 수익률이 0.3% 이상이고, 볼린저 밴드 중심선(Mid) 도달 시 보유량의 50% 매도.

최종 익절 (Sell All):

볼린저 밴드 상단(Upper) 터치 시 전량 매도.

또는 RSI가 70(RSI_SELL_THRESHOLD) 이상(과매수) 도달 시 전량 매도.

트레일링 스탑 (Trailing Stop): 수익률이 0.5% 이상 도달 후, 고점 대비 0.3% 하락하면 이익 보존을 위해 전량 매도.

B. 손절 (Stop Loss)
가격 손절: 수익률이 -1.5%(STOP_LOSS_PCT) 도달 시 즉시 손절.

지표 손절 (Trend Broken):

VWAP 붕괴: 진입 3분 후, 가격이 VWAP보다 1% 이상 하락하면 추세 이탈로 보고 손절.

RSI 투매: 진입 5분 후, RSI가 15(RSI_PANIC_SELL) 미만으로 떨어지면 패닉셀로 보고 손절.

시간 손절 (Time Cut): 진입 후 **3분(180초)**이 지났는데 수익률이 0.2% 미만이면 기회비용 확보를 위해 종료.

4. 🛡️ 안전장치 및 자금 관리 (Risk & Safety)
동적 사이징 (Dynamic Sizing): 무리한 투자를 막기 위해 매수 금액을 제한합니다. (execution/order_manager.py)

자산 제한: 내 현금 잔고의 **25%**까지만 한 종목에 투자.

호가 제한: 호가창 매도 잔량(1~5호가)의 **10%**까지만 주문 (슬리피지 방지).

거시경제 필터 (Macro Filter): 미국 나스닥 개장 전후(23:20 ~ 23:40)나 중요 경제 지표 발표 시 매매를 1분간 일시 정지합니다.

호가창 매도 전략: 매도 시 매도벽이 너무 두꺼우면(Ask > Bid * 3) 지정가 대신 시장가로 급하게 처분합니다.

5. 📝 시스템 아키텍처 및 로깅
AI Auto Pilot: 4시간마다 auto_tuner_loop가 설정을 최적화하고 타겟 코인을 교체합니다.

실시간 대응: DataAggregator가 웹소켓을 통해 가격, 체결 데이터(Trade), 설정 변경을 실시간으로 감지합니다.

기록 (Logging): 모든 매수/매도 행위는 trade_logger.py를 통해 trade_history.csv 파일에 타임스탬프, 진입 사유, 당시 지표 값(RSI, VWAP), 수익률과 함께 상세히 저장됩니다.